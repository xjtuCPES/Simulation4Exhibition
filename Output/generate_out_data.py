'''
......................................&&.........................
....................................&&&..........................
.................................&&&&............................
...............................&&&&..............................
.............................&&&&&&..............................
...........................&&&&&&....&&&..&&&&&&&&&&&&&&&........
..................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&..............
................&...&&&&&&&&&&&&&&&&&&&&&&&&&&&&.................
.......................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&.........
...................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...............
..................&&&   &&&&&&&&&&&&&&&&&&&&&&&&&&&&&............
...............&&&&&@  &&&&&&&&&&..&&&&&&&&&&&&&&&&&&&...........
..............&&&&&&&&&&&&&&&.&&....&&&&&&&&&&&&&..&&&&&.........
..........&&&&&&&&&&&&&&&&&&...&.....&&&&&&&&&&&&&...&&&&........
........&&&&&&&&&&&&&&&&&&&.........&&&&&&&&&&&&&&&....&&&.......
.......&&&&&&&&.....................&&&&&&&&&&&&&&&&.....&&......
........&&&&&.....................&&&&&&&&&&&&&&&&&&.............
..........&...................&&&&&&&&&&&&&&&&&&&&&&&............
................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&............
..................&&&&&&&&&&&&&&&&&&&&&&&&&&&&..&&&&&............
..............&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&....&&&&&............
...........&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&......&&&&............
.........&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&.........&&&&............
.......&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...........&&&&............
......&&&&&&&&&&&&&&&&&&&...&&&&&&...............&&&.............
.....&&&&&&&&&&&&&&&&............................&&..............
....&&&&&&&&&&&&&&&.................&&...........................
...&&&&&&&&&&&&&&&.....................&&&&......................
...&&&&&&&&&&.&&&........................&&&&&...................
..&&&&&&&&&&&..&&..........................&&&&&&&...............
..&&&&&&&&&&&&...&............&&&.....&&&&...&&&&&&&.............
..&&&&&&&&&&&&&.................&&&.....&&&&&&&&&&&&&&...........
..&&&&&&&&&&&&&&&&..............&&&&&&&&&&&&&&&&&&&&&&&&.........
..&&.&&&&&&&&&&&&&&&&&.........&&&&&&&&&&&&&&&&&&&&&&&&&&&.......
...&&..&&&&&&&&&&&&.........&&&&&&&&&&&&&&&&...&&&&&&&&&&&&......
....&..&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...........&&&&&&&&.....
.......&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&..............&&&&&&&....
.......&&&&&.&&&&&&&&&&&&&&&&&&..&&&&&&&&...&..........&&&&&&....
........&&&.....&&&&&&&&&&&&&.....&&&&&&&&&&...........&..&&&&...
.......&&&........&&&.&&&&&&&&&.....&&&&&.................&&&&...
.......&&&...............&&&&&&&.......&&&&&&&&............&&&...
........&&...................&&&&&&.........................&&&..
.........&.....................&&&&........................&&....
...............................&&&.......................&&......
................................&&......................&&.......
.................................&&..............................
..................................&..............................
'''

'''
Author: gwyxjtu
Date: 2022-05-31 22:56:55
LastEditors: gwyxjtu 867718012@qq.com
LastEditTime: 2022-06-06 20:36:08
FilePath: /optimization/Output/generate_out_data.py
Description: 人一生会遇到约2920万人,两个人相爱的概率是0.000049,所以你不爱我,我不怪你.

Copyright (c) 2022 by gwyxjtu 867718012@qq.com, All Rights Reserved. 
'''
import pandas as pd
import numpy as np
import pprint
import datetime

time = 24
def generate_data(time):
    dict_control = {# 负荷
        'time':1,
        # thermal binary
        'b_hp':[0]*time,
        'b_eb':[0]*time,
        'b_ht':[0]*time,
        'b_ct':[0]*time,

        # ele
        'p_hp':[100]*time,
        'p_eb':[100]*time,
        'p_pu':[100]*time,#水泵
        'p_fc':[100]*time,
        'p_el':[100]*time,

        # hydrogen
        'h_hst':[0]*time,
        'hydrogen_bottle':[0]*time,


        # thermal continuous
        't_ht':[60]*time,
        't_ct':[10]*time,
        't_mp':[60]*time,# main pipe temperature
        'm_mp':[10]*time,# main pipe mass flow

    }
    dict_plot = {
        #ele
        'p_pur':[100]*time,#电网下电
        'p_pv':[100]*time,#光伏
        'p_fc':[100]*time,

        'p_hp':[100]*time,
        'p_eb':[100]*time,
        'p_pump':[100]*time,#水泵
        'p_el':[100]*time,
        'p_load':[100]*time,

        #hydrogen
        'h_hst':[0]*time,
        'h_pur':[0]*time,
        'h_el':[0]*time,
        'h_fc':[0]*time,

        #thermal
        't_ht':[60]*time,  
        'g_ht':[60]*time,

        'g_load':[50]*time,
        'g_hp':[50]*time,
        'g_eb':[50]*time,

        # cold
        't_ct':[10]*time,
        'q_hp':[10]*time,
        
        # operational day cost
        'opex_without_opt':[0]*time,# 未经优化的运行成本
        'opex':[0]*time,

    }
    return dict_control,dict_plot

now = datetime.datetime.now()
tmp24_control,tmp24_plot = generate_data(24)
tmp24_control['day'] = now.strftime("%d")
tmp24_plot['day'] = now.strftime("%d")
tmp4_control,tmp4_plot = generate_data(4)
tmp4_control['time'] = now.strftime("%H")
tmp4_plot['time'] = now.strftime("%H")


tmp24_control = pd.DataFrame(tmp24_control)
tmp24_control.to_excel('Output/control_output_24.xls')

tmp24_plot = pd.DataFrame(tmp24_plot)
tmp24_plot.to_excel('Output/plot_output_24.xls')

tmp4_control = pd.DataFrame(tmp4_control)
tmp4_control.to_excel('Output/control_output_4.xls')
tmp4_plot = pd.DataFrame(tmp4_plot)
tmp4_plot.to_excel('Output/plot_output_4.xls')
# to list
#ans = pd.read_excel('input_day.xls')
#print(list(ans['g_load'])) 
